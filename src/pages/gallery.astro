---
import Layout from '../layouts/Layout.astro';
import Navbar from '../components/Navbar.astro';
import AntigravityBg from '../components/AntigravityBg.astro';
import Footer from '../components/Footer.astro';
import { Image } from 'astro:assets';

// Import gallery images
import img1 from '../assets/images/TTPOA Images/1.jpeg';
import img2 from '../assets/images/TTPOA Images/2.jpeg';
import img3 from '../assets/images/TTPOA Images/3.jpeg';
import img4 from '../assets/images/TTPOA Images/4.jpeg';
import img5 from '../assets/images/TTPOA Images/5.jpeg';
import img6 from '../assets/images/TTPOA Images/6.jpeg';
import img7 from '../assets/images/TTPOA Images/7.jpeg';
import img8 from '../assets/images/TTPOA Images/8.jpeg';
import img9 from '../assets/images/TTPOA Images/9.jpeg';
import img10 from '../assets/images/TTPOA Images/10.jpeg';
import imgMain from '../assets/images/TTPOA Images/Main.jpeg';
import imgWhatsApp from '../assets/images/TTPOA Images/WhatsApp Image 2026-02-06 at 11.45.10 AM.jpeg';

// Events data with their respective images
const events = [
  {
    id: 'annual-summit-2026',
    title: 'Annual Placement Summit 2026',
    date: 'February 5, 2026',
    description: 'Successfully conducted the Annual Placement Summit with participation from 200+ colleges.',
    images: [
      { src: imgMain, alt: 'Annual Summit - Main Event' },
      { src: img1, alt: 'Annual Summit - Session 1' },
      { src: img2, alt: 'Annual Summit - Session 2' }
    ]
  },
  {
    id: 'skill-workshop-2026',
    title: 'Skill Development Workshop',
    date: 'January 28, 2026',
    description: 'AI, Machine Learning, and Data Science workshop for students across member institutions.',
    images: [
      { src: img3, alt: 'Workshop - AI Session' },
      { src: img4, alt: 'Workshop - ML Training' },
      { src: img5, alt: 'Workshop - Data Science' }
    ]
  },
  {
    id: 'industry-partnership-2026',
    title: 'Industry Partnership Initiative',
    date: 'January 15, 2026',
    description: 'Launched partnerships with 25+ tech companies for enhanced placement opportunities.',
    images: [
      { src: img6, alt: 'Partnership Event' },
      { src: img7, alt: 'Industry Leaders Meet' }
    ]
  },
  {
    id: 'tpo-training-2025',
    title: 'TPO Training Program',
    date: 'December 20, 2025',
    description: 'Specialized training for TPOs on modern placement strategies and digital tools.',
    images: [
      { src: img8, alt: 'TPO Training Session' },
      { src: img9, alt: 'Training Workshop' }
    ]
  },
  {
    id: 'virtual-job-fair-2025',
    title: 'Virtual Job Fair 2025',
    date: 'November 30, 2025',
    description: 'Connecting 10,000+ students with 100+ companies, resulting in 2,500+ offers.',
    images: [
      { src: img10, alt: 'Virtual Job Fair' },
      { src: imgWhatsApp, alt: 'Job Fair Success' }
    ]
  }
];
---

<Layout title="Gallery - TTPOA">
  <AntigravityBg />
  <Navbar currentPage="gallery" />
  
  <main class="pt-16 lg:pt-20">
    <!-- Hero Section -->
    <section class="bg-gradient-to-br from-blue-50/30 via-transparent to-orange-50/30 backdrop-blur-sm py-20">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center max-w-3xl mx-auto">
          <span class="fade-up inline-block bg-blue-100 text-blue-700 px-4 py-2 rounded-full text-sm font-medium mb-4">
            Our Events
          </span>
          <h1 class="fade-up delay-100 text-4xl md:text-5xl font-bold text-white mb-6">
            Event <span class="gradient-text">Gallery</span>
          </h1>
          <p class="fade-up delay-200 text-lg text-white/90 leading-relaxed">
            Explore moments from our events, workshops, and initiatives that shape the future of placements across Telangana.
          </p>
        </div>
      </div>
    </section>

    <!-- Event Timeline -->
    <section class="section-padding bg-gradient-to-br from-blue-50/10 via-transparent to-orange-50/10 backdrop-blur-sm">
      <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
        <!-- Timeline Container -->
        <div class="mb-12">
          <h2 class="text-2xl md:text-3xl font-bold text-white text-center mb-8 fade-up">
            Select an <span class="gradient-text">Event</span>
          </h2>
          
          <!-- Timeline -->
          <div class="relative">
            <!-- Timeline Line -->
            <div class="hidden md:block absolute top-1/2 left-0 right-0 h-1 bg-gradient-to-r from-blue-500/30 via-orange-500/30 to-blue-500/30 rounded-full transform -translate-y-1/2"></div>
            
            <!-- Timeline Events -->
            <div class="flex flex-col md:flex-row justify-between items-center gap-4 md:gap-2 relative z-10">
              {events.map((event, index) => (
                <button
                  class={`timeline-btn group flex flex-col items-center text-center transition-all duration-500 ${index === 0 ? 'active' : ''}`}
                  data-event-id={event.id}
                >
                  <!-- Circle -->
                  <div class="w-16 h-16 rounded-full bg-gradient-to-br from-blue-600 to-orange-600 flex items-center justify-center mb-3 group-hover:scale-110 transition-transform duration-300 shadow-lg group-hover:shadow-orange-500/50">
                    <div class="w-14 h-14 rounded-full bg-gray-900/90 flex items-center justify-center">
                      <span class="text-xl font-bold text-white">{index + 1}</span>
                    </div>
                  </div>
                  
                  <!-- Event Info -->
                  <div class="max-w-[140px]">
                    <h3 class="text-sm font-bold text-white/90 group-hover:text-orange-400 transition-colors duration-300 leading-tight mb-1">
                      {event.title}
                    </h3>
                    <p class="text-xs text-white/60 group-hover:text-white/80 transition-colors duration-300">
                      {event.date}
                    </p>
                  </div>
                </button>
              ))}
            </div>
          </div>
        </div>

        <!-- Event Details -->
        {events.map((event, eventIndex) => (
          <div 
            class={`event-content ${eventIndex === 0 ? 'active' : 'hidden'}`}
            data-event-id={event.id}
          >
            <!-- Event Header -->
            <div class="bg-gradient-to-r from-blue-600/20 to-orange-600/20 backdrop-blur-sm rounded-2xl p-6 mb-8 border border-white/10">
              <h3 class="text-2xl md:text-3xl font-bold text-white mb-2">{event.title}</h3>
              <p class="text-orange-400 font-semibold mb-3">{event.date}</p>
              <p class="text-white/80 leading-relaxed">{event.description}</p>
            </div>

            <!-- Event Gallery -->
            <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6">
              {event.images.map((image, imgIndex) => (
                <div 
                  class={`gallery-item fade-up delay-${(imgIndex % 3 + 1) * 100} group relative overflow-hidden rounded-2xl shadow-xl hover:shadow-2xl transition-all duration-500 cursor-pointer`}
                  data-event={event.id}
                  data-index={imgIndex}
                >
                  <div class="relative overflow-hidden aspect-[4/3]">
                    <Image 
                      src={image.src} 
                      alt={image.alt}
                      class="w-full h-full object-cover transform group-hover:scale-110 transition-transform duration-700 ease-out"
                    />
                    <!-- Overlay -->
                    <div class="absolute inset-0 bg-gradient-to-t from-black/80 via-black/40 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500 flex items-end justify-center p-6">
                      <div class="transform translate-y-4 group-hover:translate-y-0 transition-transform duration-500">
                        <p class="text-white text-lg font-semibold text-center">{image.alt}</p>
                      </div>
                    </div>
                    <!-- Magnifier Icon -->
                    <div class="absolute top-4 right-4 w-10 h-10 bg-white/90 rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transform scale-0 group-hover:scale-100 transition-all duration-300">
                      <svg class="w-5 h-5 text-blue-600" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0zM10 7v3m0 0v3m0-3h3m-3 0H7"/>
                      </svg>
                    </div>
                  </div>
                </div>
              ))}
            </div>
          </div>
        ))}
      </div>
    </section>
  </main>

  <Footer />

  <!-- Lightbox Modal -->
  <div id="lightbox" class="fixed inset-0 bg-black/95 z-50 hidden items-center justify-center p-4">
    <button id="close-lightbox" class="absolute top-4 right-4 text-white hover:text-orange-400 transition-colors z-10">
      <svg class="w-10 h-10" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
      </svg>
    </button>
    
    <!-- Previous Button -->
    <button id="prev-image" class="absolute left-4 text-white hover:text-orange-400 transition-colors z-10">
      <svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"/>
      </svg>
    </button>

    <!-- Next Button -->
    <button id="next-image" class="absolute right-4 text-white hover:text-orange-400 transition-colors z-10">
      <svg class="w-12 h-12" fill="none" stroke="currentColor" viewBox="0 0 24 24">
        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
      </svg>
    </button>

    <div class="max-w-6xl max-h-[90vh] overflow-hidden rounded-lg">
      <img id="lightbox-image" src="" alt="" class="max-w-full max-h-[90vh] object-contain animate-fade-in" />
    </div>
  </div>

  <style>
    @keyframes fade-in {
      from {
        opacity: 0;
        transform: scale(0.9);
      }
      to {
        opacity: 1;
        transform: scale(1);
      }
    }

    @keyframes slide-in {
      from {
        opacity: 0;
        transform: translateY(20px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    .animate-fade-in {
      animation: fade-in 0.3s ease-out;
    }

    .event-content {
      animation: slide-in 0.5s ease-out;
    }

    .event-content.hidden {
      display: none;
    }

    .event-content.active {
      display: block;
    }

    .timeline-btn.active .w-16 {
      box-shadow: 0 0 0 4px rgba(249, 115, 22, 0.3);
      transform: scale(1.1);
    }

    .timeline-btn.active h3 {
      color: #fb923c;
    }
  </style>

  <script>
    document.addEventListener('DOMContentLoaded', () => {
      // Timeline functionality
      const timelineBtns = document.querySelectorAll('.timeline-btn');
      const eventContents = document.querySelectorAll('.event-content');

      timelineBtns.forEach(btn => {
        btn.addEventListener('click', () => {
          const eventId = btn.getAttribute('data-event-id');
          
          // Remove active class from all buttons
          timelineBtns.forEach(b => b.classList.remove('active'));
          // Add active class to clicked button
          btn.classList.add('active');
          
          // Hide all event contents with fade out
          eventContents.forEach(content => {
            content.classList.remove('active');
            content.classList.add('hidden');
          });
          
          // Show selected event content with fade in
          const selectedContent = document.querySelector(`.event-content[data-event-id="${eventId}"]`);
          if (selectedContent) {
            setTimeout(() => {
              selectedContent.classList.remove('hidden');
              selectedContent.classList.add('active');
            }, 100);
          }
        });
      });

      // Lightbox functionality
      const galleryItems = document.querySelectorAll('.gallery-item');
      const lightbox = document.getElementById('lightbox');
      const lightboxImage = document.getElementById('lightbox-image') as HTMLImageElement;
      const closeLightbox = document.getElementById('close-lightbox');
      const prevButton = document.getElementById('prev-image');
      const nextButton = document.getElementById('next-image');
      let currentEventImages: { src: string; alt: string }[] = [];
      let currentIndex = 0;

      function updateCurrentImages() {
        const activeEvent = document.querySelector('.event-content.active');
        if (!activeEvent) return;
        
        const eventImages = activeEvent.querySelectorAll('.gallery-item img');
        currentEventImages = Array.from(eventImages).map(img => ({
          src: (img as HTMLImageElement).src || '',
          alt: (img as HTMLImageElement).alt || ''
        }));
      }

      function showImage(index: number) {
        if (currentEventImages.length === 0) return;
        
        currentIndex = index;
        lightboxImage.src = currentEventImages[index].src;
        lightboxImage.alt = currentEventImages[index].alt;
        lightbox?.classList.remove('hidden');
        lightbox?.classList.add('flex');
        // Trigger animation
        lightboxImage.classList.remove('animate-fade-in');
        void lightboxImage.offsetWidth; // Force reflow
        lightboxImage.classList.add('animate-fade-in');
      }

      function hideImage() {
        lightbox?.classList.add('hidden');
        lightbox?.classList.remove('flex');
      }

      function showPrevious() {
        currentIndex = (currentIndex - 1 + currentEventImages.length) % currentEventImages.length;
        showImage(currentIndex);
      }

      function showNext() {
        currentIndex = (currentIndex + 1) % currentEventImages.length;
        showImage(currentIndex);
      }

      galleryItems.forEach((item) => {
        item.addEventListener('click', () => {
          updateCurrentImages();
          const index = parseInt(item.getAttribute('data-index') || '0');
          showImage(index);
        });
      });

      closeLightbox?.addEventListener('click', hideImage);
      prevButton?.addEventListener('click', showPrevious);
      nextButton?.addEventListener('click', showNext);

      // Close on escape key
      document.addEventListener('keydown', (e) => {
        if (e.key === 'Escape') hideImage();
        if (e.key === 'ArrowLeft') showPrevious();
        if (e.key === 'ArrowRight') showNext();
      });

      // Close when clicking outside image
      lightbox?.addEventListener('click', (e) => {
        if (e.target === lightbox) hideImage();
      });

      // Initialize current images
      updateCurrentImages();
    });
  </script>
</Layout>
